apiVersion: batch/v1
kind: Job
metadata:
  name: init-db-user
  namespace: database
spec:
  template:
    spec:
      containers:
      - name: init-db-user
        image: docker.io/bitnami/mysql:8.0.28-debian-10-r23
        command:
        - /bin/run.sh
        volumeMounts:
        - name: db-secret
          mountPath: /db
        - mountPath: /bin/run.sh
          name: hook-scripts
          readOnly: true
          subPath: mysql-init.sh
      volumes:
      - name: hook-scripts
        configMap:
          name: hook-scripts
          deaultMode: 504
      - name: db-secret
        secret:
          secretName:  mysql-auth-secret
          optional: false
      restartPolicy: Never
  backoffLimit: 10
