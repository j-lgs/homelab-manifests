---
- name: Process secrets
  hosts: localhost
  vars:
    minio_root_user: "root"
    minio_root_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          31343439333436316432343233633836613061653462626134376663376563386361313534666563
          3930643365343961643538333533303534653735643630640a643739353537333439313561636161
          62623735306661346465306432323661313266616662383038616335306163353635343761653862
          3435643464623734620a323565346434646239656333626364363532373038393534326333333065
          39303335343032343034366434313437383038666134376339306334326637353738
    minio_user_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          31396362633362396130343031313738326430623530353265316535653033316261353938316435
          3736616161323237346164303761653330383438313635620a343438313162356136656536393862
          66643063353537326163633264313531363265353833643365306439313039343461313837656630
          3462356262633632380a386132303466356566383134393534626537643439666438326464633430
          36613035646335636465356530653861613838383162393530643066363365343665
    velero_user_key_id: "minio"
    velero_user_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          61383337666632316332616662383765363665396565333834666533633639656461373433666232
          3536383537326137613339636632613362303733336234630a643833393564326131323762353037
          34323437393133356237306263616330633539393539326261363865386338633164323933646436
          3933323438303831310a396637393165376130373234316435393332663861313361393435396566
          62336236333562343338373338366664653030386265366337303564666532376163
    truenas_host: "10.0.1.10"
    truenas_apikey: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          66326264363635353537643263316465656438613763393563306564663361316562343635323830
          3262353766616230336265363130386234623734646365620a613332626561313261393237643336
          64623836623563303630656530303266306538353064343739643938653832336463613337363262
          6530373961323836360a656136316639613535393137323361376432353665356531303239356163
          35363963613030313466363437303164646464393035663566363032313337343330396435613065
          36323964373934396331386239326436383263616434643136666131353831656435316332363864
          38373437646262626139636231643830393330656430663039336161613934383938633435376463
          37383837373239356362

    truenas_ssh_user: "root"
    truenas_ssh_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          37636532333932656362653762613037373662353265393537396635316639653138626664613038
          3364346263636334613761646635386666313138613232610a613665313366353636373939643631
          30353933646236386436656664366539336635386131663739373935626233653963386266356634
          3436396435663864630a303261346661333935666234333262386661376534336132656331343338
          3439
    truenas_share_user: "root"
    truenas_share_group: "wheel"
    truenas_dataset_user: "0"
    truenas_dataset_group: "0"
    truenas_share_network: 10.0.1.0/24
    mysql_root_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          34346564383562653538396537393964666430353164373366626330346435663835376264646664
          3066393530663439623031636430643234613731313237320a373036613032663333616535393232
          30616132393438643338373361613532643366646330323264656134343635613364353933316238
          3262393636613336330a326663633163326430363533633434666430613766333535626336326537
          64613263356261343135396661326633636435366339623166373136383665613831
    mysql_user_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          30653530373166353661653431643464643265383661376166303133313930363962333536643761
          3535613763313062363735626462376432373936313439340a383830643139313564636536623939
          66333135653931643032313839363637633463313233333738353834383337623533616263626339
          6665343235323135620a656239366431373663656264353839326234653563346161353932363532
          38633330323336626233336133636532353931353735363162633364616664636130
    gitea_db_name: "giteadb"
    gitea_db_username: "gitea"
    gitea_admin_username: "git-admin"
    gitea_admin_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          31353564373330643562356164393632663531306362616237623764623761633537333134636535
          3164633930653931336330386134616262633832303731310a333039613935306565356337313233
          65363161653936373534336637623364396239356534386536386639623164303636366230323439
          6630316561633233320a373131363464313430343231363039396636663363653130323965616565
          66616630653239343864383530383331353833616537396637393738376562663937
  tasks:
  - name: Template secrets
    shell: echo "{{ lookup('template', 'secrets/'+item+'.j2') }}" | kubeseal --format=yaml > apps/templates/secrets/{{ item }}
    loop:
    - 'minio-access-secret.yaml'
    - 'cloud-credentials.yaml'
    - 'democratic-csi-config-secret.yaml'
    - 'mysql-auth-secret.yaml'
    - 'mysql-credential-files-secret.yaml'
    - 'gitea-credential-files-secret.yaml'
    - 'gitea-database-secret.yaml'
    - 'gitea-admin-secret.yaml'
    - 'gitea-credential-files-secret.yaml'
    
